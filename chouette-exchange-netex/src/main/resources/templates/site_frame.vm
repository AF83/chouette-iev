<!-- =========================================== -->
<!-- NEPTUNE StopPlaces (StopArea of type StopPlace) are mapped to NeTEx StopPlace -->
<SiteFrame version="any" id="${line.objectIdPrefix()}:SiteFrame:SF01"> 
  <stopPlaces>
    #foreach( $stopPlace in $stopPlaces )
    <StopPlace version="$stopPlace.objectVersion" id="${stopPlace.objectIdPrefix()}:StopPlace:${stopPlace.objectIdSuffix()}">
     #if( $stopPlace.name )
     <Name>$!esc.xml( $stopPlace.name)</Name>
     #end

     #if( $stopPlace.comment )
     <Description>$!esc.xml( $stopPlace.comment)</Description>
     #end

     #if( $stopPlace.registrationNumber )
     <PrivateCode>$!esc.xml( $stopPlace.registrationNumber)</PrivateCode>
     #end

      #if( ( $stopPlace.latitude && $stopPlace.longitude) || ( $stopPlace.x && $stopPlace.y && $stopPlace.projectionType))
      <Centroid>
        <Location id="${stopPlace.objectIdPrefix()}:Location:${stopPlace.objectIdSuffix()}">
          #if ( $stopPlace.longitude && $stopPlace.latitude )
          <Longitude>$stopPlace.longitude</Longitude>
          <Latitude>$stopPlace.latitude</Latitude>
          #end
          #if ( $stopPlace.x && $stopPlace.y && $stopPlace.projectionType)
          <gml:pos srsName="$stopPlace.projectionType">$stopPlace.x $stopPlace.y</gml:pos>
          #end
        </Location>
      </Centroid>
      #end
      #if($stopPlace.streetName || $stopPlace.countryCode)
      <PostalAddress version="any" id="${stopPlace.objectIdPrefix()}:PostalAddress:${stopPlace.objectIdSuffix()}">
        <CountryRef ref="fr"/>
        #if ( $stopPlace.streetName )
        <AddressLine1>$!esc.xml( $stopPlace.streetName)</AddressLine1>
        #end
        #if ( $stopPlace.countryCode )
        <PostCode>$!esc.xml( $stopPlace.countryCode)</PostCode>
        #end
      </PostalAddress>
      #end

     #if( $stopPlace.parent )
     <ParentZoneRef version="$stopPlace.parent.objectVersion" ref="${stopPlace.parent.objectIdPrefix()}:StopPlace:${stopPlace.parent.objectIdSuffix()}" />
     #end
      
      #if( $stopPlace.nearestTopicName )
      <LandMark>$!esc.xml( $stopPlace.nearestTopicName)</LandMark>
      #end

      #if($stopPlace.fareCode)
      <tariffZones>
        <TariffZoneRef version="any" ref="${stopPlace.objectIdPrefix()}:TariffZone:${stopPlace.fareCode}"/>
      </tariffZones>
      #end
      <quays>
        #foreach( $quay in $stopPlace.containedStopAreas )
        <Quay version="$quay.objectVersion" id="${quay.objectIdPrefix()}:Quay:${quay.objectIdSuffix()}">
         #if( $quay.name )
         <Name>$!esc.xml( $quay.name)</Name>
         #end

         #if( $quay.comment )
         <Description>$!esc.xml( $quay.comment)</Description>
         #end

         #if( $quay.registrationNumber )
         <PrivateCode>$!esc.xml( $quay.registrationNumber)</PrivateCode>
         #end

         #if( $quay.nearestTopicName )
         <LandMark>$!esc.xml( $quay.nearestTopicName)</LandMark>
         #end

         #if( ( $quay.latitude && $quay.longitude) || ($quay.x && $quay.y && $quay.projectionType))
         <Centroid>
            <Location id="${quay.objectIdPrefix()}:Location:${quay.objectIdSuffix()}">
              #if ( $quay.longitude && $quay.latitude )
              <Longitude>$quay.longitude</Longitude>
              <Latitude>$quay.latitude</Latitude>
              #end
              #if ( $quay.x && $quay.y && $quay.projectionType)
              <gml:pos srsName="$quay.projectionType">$quay.x $quay.y</gml:pos>
              #end
            </Location>
          </Centroid>
          #end
          #if($quay.streetName || $quay.countryCode)
          <PostalAddress version="any" id="${quay.objectIdPrefix()}:PostalAddress:${quay.objectIdSuffix()}">
            <CountryRef ref="fr"/>
            #if ( $quay.streetName )
            <AddressLine1>$!esc.xml( $quay.streetName)</AddressLine1>
            #end
            #if ( $quay.countryCode )
            <PostCode>$!esc.xml( $quay.countryCode)</PostCode>
            #end
          </PostalAddress>
          #end
          #if($quay.fareCode)
          <tariffZones>
            <TariffZoneRef version="any" ref="${quay.objectIdPrefix()}:TariffZone:${quay.fareCode}"/>
          </tariffZones>
          #end
        </Quay>	
        #end	
      </quays>
      <entrances>
        #foreach( $accessPoint in $accessPoints )
        <StopPlaceEntrance version="any" ref="${accessPoint.objectIdPrefix()}:StopPlaceEntrance:${accessPoint.objectIdSuffix()}">
          <Centroid>
            <Location>
              <Longitude>$!accessPoint.longitude</Longitude>
              <Latitude>$!accessPoint.latitude</Latitude>
              <srsName>$!accessPoint.longLatType</srsName>
            </Location>
          </Centroid> 
          <StopPlaceEntranceRef ref="$accessPoint.containedIn"/>
          #if ( $accessPoint.name )
          <Name>$!esc.xml($accessPoint.name)</Name>          
          #end
          <isEntry>#if( $accessPoint.type == "In" || $accessPoint.type == "In Out")true#{else}false#end</isEntry>
          <isExit>#if( $accessPoint.type == "Out" || $accessPoint.type == "In Out")true#{else}false#end</isExit>         
          <TimeBand>
            <StartTime>$!accessPoint.openingTime</StartTime>
            <EndTime>$!accessPoint.closingTime</EndTime>
          </TimeBand>
          #if ( $accessPoint.comment )
          <Description>$!esc.xml($accessPoint.comment)</Description>  
          #end
          ## TODO : Add enum   
        </StopPlaceEntrance> 
        #end
      </entrances> 
    </StopPlace>
    #end				
  </stopPlaces>
  <!-- Assignments of Path Links -->
  <pathLinks>
    #foreach( $accessLink in $accessLinks )       
    <PathLink id="${accessLink.objectIdPrefix()}:PathLink:${accessLink.objectIdSuffix()}" version="$accessLink.objectVersion">  
      #if ( $accessLink.name )
      <Name>$!esc.xml($accessLink.name)</Name>
      #end
      <From>
        <EntranceRef ref="$accessLink.accessPoint.objectId" />
      </From>
      <To> 
        <PlaceRef ref="$accessLink.stopArea.objectId" /> 
      </To> 
      <Distance>$!accessLink.linkDistance</Distance>
      #set($linkType = $accessLink.linkType)
      #if ( $linkType == "Underground" ) 
        <Covered>indoors</Covered>
      #elseif ( $linkType == "Overground" )
        <Covered>outdoors</Covered>
      #elseif ( $linkType == "Mixed" )
        <Covered>mixed</Covered>
      #else
        <Covered>unknown</Covered>
      #end 
      <TransfertDuration>
        <DefaultDuration>$!accessLink.defaultDuration</DefaultDuration>
        <FrequentTravellerDuration>$!accessLink.frequentTravellerDuration</FrequentTravellerDuration>
        <OccasionalTravellerDuration>$!accessLink.occasionalTravellerDuration</OccasionalTravellerDuration>
        <MobilityRestrictedTravellerDuration>$!accessLink.mobilityRestrictedTravellerDuration</MobilityRestrictedTravellerDuration> 
      </TransfertDuration>
      <AccessibilityAssesment>
        <MobilityimpairedAccess>$!accessLink.mobilityRestrictedSuitable</MobilityimpairedAccess>
      </AccessibilityAssesment>
      ## TODO : Add enum  
    </PathLink>
    #end
  </pathLinks>  

</SiteFrame>

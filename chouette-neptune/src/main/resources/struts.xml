<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE struts PUBLIC
"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
"http://struts.apache.org/dtds/struts-2.0.dtd">

<struts>
    <constant name="struts.mapper.class" value="rest" />
    
    <!-- Constantes pour le plugin Convention -->
    <constant name="struts.convention.action.suffix" value="Controller"/>
    <constant name="struts.convention.action.mapAllMatches" value="true"/>
    <constant name="struts.convention.default.parent.package" value="rest-default"/>

  <package name="struts" extends="json-default">
    <interceptors>
      <interceptor name="singleAction"
                   class="fr.certu.chouette.struts.interceptor.SingleActionInterceptor" />
      <interceptor name="alias"
                   class="com.opensymphony.xwork2.interceptor.AliasInterceptor" />
      <interceptor name="chain"
                   class="com.opensymphony.xwork2.interceptor.ChainingInterceptor" />
      <interceptor name="conversionError"
                   class="org.apache.struts2.interceptor.StrutsConversionErrorInterceptor" />
      <interceptor name="cookie"
                   class="org.apache.struts2.interceptor.CookieInterceptor" />
      <interceptor name="clearSession"
                   class="org.apache.struts2.interceptor.ClearSessionInterceptor" />
      <interceptor name="createSession"
                   class="org.apache.struts2.interceptor.CreateSessionInterceptor" />
      <interceptor name="debugging"
                   class="org.apache.struts2.interceptor.debugging.DebuggingInterceptor" />
      <interceptor name="externalRef"
                   class="com.opensymphony.xwork2.interceptor.ExternalReferencesInterceptor" />
      <interceptor name="execAndWait"
                   class="org.apache.struts2.interceptor.ExecuteAndWaitInterceptor" />
      <interceptor name="exception"
                   class="com.opensymphony.xwork2.interceptor.ExceptionMappingInterceptor" />
      <interceptor name="fileUpload"
                   class="org.apache.struts2.interceptor.FileUploadInterceptor" />
      <interceptor name="i18n"
                   class="com.opensymphony.xwork2.interceptor.I18nInterceptor" />
      <interceptor name="logger"
                   class="com.opensymphony.xwork2.interceptor.LoggingInterceptor" />
      <interceptor name="modelDriven"
                   class="com.opensymphony.xwork2.interceptor.ModelDrivenInterceptor" />
      <interceptor name="scopedModelDriven"
                   class="com.opensymphony.xwork2.interceptor.ScopedModelDrivenInterceptor" />
      <interceptor name="params"
                   class="com.opensymphony.xwork2.interceptor.ParametersInterceptor" />
      <interceptor name="actionMappingParams"
                   class="org.apache.struts2.interceptor.ActionMappingParametersInteceptor" />
      <interceptor name="prepare"
                   class="com.opensymphony.xwork2.interceptor.PrepareInterceptor" />
      <interceptor name="staticParams"
                   class="com.opensymphony.xwork2.interceptor.StaticParametersInterceptor" />
      <interceptor name="scope"
                   class="org.apache.struts2.interceptor.ScopeInterceptor" />
      <interceptor name="servletConfig"
                   class="org.apache.struts2.interceptor.ServletConfigInterceptor" />
      <interceptor name="sessionAutowiring"
                   class="org.apache.struts2.spring.interceptor.SessionContextAutowiringInterceptor" />
      <interceptor name="timer"
                   class="com.opensymphony.xwork2.interceptor.TimerInterceptor" />
      <interceptor name="token"
                   class="org.apache.struts2.interceptor.TokenInterceptor" />
      <interceptor name="tokenSession"
                   class="org.apache.struts2.interceptor.TokenSessionStoreInterceptor" />
      <interceptor name="validation"
                   class="org.apache.struts2.interceptor.validation.AnnotationValidationInterceptor" />
      <interceptor name="workflow"
                   class="com.opensymphony.xwork2.interceptor.DefaultWorkflowInterceptor" />

      <interceptor name="checkbox"
                   class="org.apache.struts2.interceptor.CheckboxInterceptor" />
      <interceptor name="profiling"
                   class="org.apache.struts2.interceptor.ProfilingActivationInterceptor" />
      <interceptor name="roles"
                   class="org.apache.struts2.interceptor.RolesInterceptor" />
      <interceptor name="jsonValidation"
                   class="org.apache.struts2.interceptor.validation.JSONValidationInterceptor" />
      <interceptor name="annotationWorkflow"
                   class="com.opensymphony.xwork2.interceptor.annotations.AnnotationWorkflowInterceptor" />
      <interceptor name="store"
                   class="org.apache.struts2.interceptor.MessageStoreInterceptor" />
      <interceptor name="multiselect"
                   class="org.apache.struts2.interceptor.MultiselectInterceptor" />

      <interceptor-stack name="crudStack">
        <interceptor-ref name="exception">
          <param name="logEnabled">true</param>
          <param name="logLevel">error</param>
        </interceptor-ref>
        <interceptor-ref name="alias" />
        <interceptor-ref name="servletConfig" />
        <interceptor-ref name="i18n" />
        <!-- <interceptor-ref name="singleAction" /> -->
        <interceptor-ref name="params">
          <param name="excludeParams">dojo\..*,^struts\..*</param>
        </interceptor-ref>
        <interceptor-ref name="prepare" />
        <interceptor-ref name="chain" />
        <interceptor-ref name="debugging" />
        <interceptor-ref name="scopedModelDriven" />
        <interceptor-ref name="modelDriven" />
        <interceptor-ref name="fileUpload" />
        <interceptor-ref name="checkbox" />
        <interceptor-ref name="multiselect" />
        <interceptor-ref name="staticParams" />
        <interceptor-ref name="actionMappingParams" />
        <interceptor-ref name="params">
          <param name="excludeParams">dojo\..*,^struts\..*</param>
        </interceptor-ref>
        <interceptor-ref name="conversionError" />
        <interceptor-ref name="validation">
          <param name="excludeMethods">input,edit,add,delete,list,cancel, ajaxBoardingPositions</param>
        </interceptor-ref>
        <interceptor-ref name="store"></interceptor-ref>
        <interceptor-ref name="workflow">
          <param name="excludeMethods">input,edit,add,delete,list,cancel, ajaxBoardingPositions</param>
        </interceptor-ref>
      </interceptor-stack>
    </interceptors>

    <default-interceptor-ref name="crudStack" />

    <!-- Action par défaut -->
    <default-action-ref name="ActionNotFound" />

    <!-- Resultats "reutilisables" -->
    <global-results>
      <result name="busy-session" type="redirect">
        <param name="location">/</param>
        <param name="busySession">true</param>
      </result>
      <result name="error">/jsp/error.jsp</result>
    </global-results>

    <!-- Traitement des erreurs -->
    <global-exception-mappings>
      <exception-mapping result="error" exception="java.lang.Exception" />
    </global-exception-mappings>

    <!-- Déconnexion -->
    <action name="deconnexion" class="Deconnexion" method="execute">
      <result name="success" type="redirect">/</result>
    </action>

    <!-- Action non trouvée -->
    <action name="ActionNotFound">
      <result>/jsp/action_not_found.jsp</result>
    </action>

</struts>
